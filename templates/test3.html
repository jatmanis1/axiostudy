<div class="container mt-5">
    <!-- Include Select2 styles -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css" rel="stylesheet" />
  
    <!-- Select2 Dropdown -->
    <select class="form-control" id="searchableDropdown" style="width: 100%;">
      <option value="" disabled selected>Find Unit</option>
      {% for i in units %}
        <option value="{{ i.id }}" data-address="{{ i.u_desc }}">{{ i.u_name }}</option>
      {% endfor %}
    </select>
  </div>
  

<!-- Include jQuery and Select2 -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.min.js"></script>

<script>
  $(document).ready(function () {
    // Initialize Select2 with a custom matcher function
    $('#searchableDropdown').select2({
      placeholder: 'Search by Name or Address...',
      allowClear: true,
      matcher: function (params, data) {
        if ($.trim(params.term) === '') {
          return data;
        }

        const searchTerm = params.term.toLowerCase();
        const text = data.text.toLowerCase(); // Search in "u_name"
        const address = $(data.element).data('address')?.toLowerCase(); // Search in "u_address"

        if (text.includes(searchTerm) || (address && address.includes(searchTerm))) {
          return data;
        }

        return null; // Exclude if no match
      }
    });
  });
</script>
